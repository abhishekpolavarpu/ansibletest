
    
node ('Ansible control server') {


stage('Deployment'){
   checkout([$class: 'GitSCM', branches: [[name: 'refs/tags/*']], doGenerateSubmoduleConfigurations: false, extensions: [], submoduleCfg: [], userRemoteConfigs: [[credentialsId: 'a2cd37c2-f0d5-4b7d-b8f2-8c833088b186', refspec: '+refs/tags/*:refs/remotes/origin/tags/*', url: 'git@github.com:abhishekpolavarpu/ansibletest.git']]])
 
 }

stage('archiving'){

   tag = VersionNumber (versionNumberString: 'Ansible-${BUILD_DATE_FORMATTED, "yyMMdd"}-${BUILD_DAY,XX}')
    echo "${tag}"
 zip archive: true, dir: '/home/jenkins/workspace/ansibletest_pipeline', glob: '', zipFile: 'artifact.zip'
 sh "mv artifact.zip '$tag'.zip"
 sh ' sudo cp *.zip /home/jenkins/Ansible/'
 sh 'sudo rm -rf *'
 }

}

 

